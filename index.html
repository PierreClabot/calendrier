<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>Calendrier</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/a761196818.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.0/js/fontawesome.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.6.2.js" integrity="sha256-pkn2CUZmheSeyssYw3vMp1+xyub4m+e+QK4sQskvuo4=" crossorigin="anonymous"></script>

</head>
<body>
    <div id="periode-selecteur">

    </div>

    <div style="margin:4rem">
        <H1>J'écoute les évents...</H1>
        <div id="PERIODEECOUTEUR"></div>

   </div>
   <a href="test.html" class="test" href="">Changement de page</a>

<script src="calendrier.js"></script>
<script>


    class EcouteurApplication  {
    
    //EcouteurApplication Class
    constructor(){
        let cal2 = new Date("2023","1","1");

        let data1={date:"20230119", idSpc : 494, tblRpr : [{idRpr:4252, heure : '10:00'},{idRpr:4258, heure:'18:00'}] };
        let data2={date:"20230110", idSpc : 495, tblRpr : [{idRpr:4252, heure : '20:00'}] };
        let data3={};
        let tbldata = [data1,data2,data3];


        let appCal = new Container(new Date(),null,false,true,tbldata,"#periode-selecteur");
        this.appCal = appCal;
        //  $(".test").on("click",function(){
        //      localStorage.setItem("dataContainer",appCal.fctCalVal_cha())
        //  })
         console.log(localStorage.getItem("dataContainer"));
         appCal.pcdCalVal(localStorage.getItem("dataContainer"));
        appCal.subscribe(this);  
    }

    //EcouteurApplicatin Class
    onPeriodeEvent(evt) {

        $('#PERIODEECOUTEUR').html('Event reçu <br>'+evt.event);
        // selon evt.event
        // traiter evt.date1 ou date 2 , etcc...
        if(evt.event == "SelectionDebut")
        {
            console.log(evt);
        }

        if(evt.event == "SelectionExtension")
        {
            console.log(evt);
        }
        
        if(evt.event == "SelectionFaite")
        {
            localStorage.setItem("dataContainer",this.appCal.fctCalVal_cha());
            console.log(evt);
        }
        if(evt.event == "Activation")
        {
            console.log(evt);
        }
        // if(evt.event == "SelectionJhesite")
        // {
        //     console.log(evt);
        // }
        if(evt.event == "HorsCaseCalendrier")
        {
            console.log(evt);
        }
        if(evt.event == "ChoixSpectacle")
        {
            console.log(evt);
        }
    }
}

// Application
//DateAdapInfo.testUnitaire();

    var appEcouteur=new EcouteurApplication();
</script>

</body>


</html>